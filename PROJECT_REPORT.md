# Отчёт по проекту GOGOMARKET

Дата: по состоянию репозитория (текущие файлы).

**Соответствие ТЗ:** код приведён в соответствие с отчётом (SELLER_FULL/SELLER_SIMPLE, Gemini, рилсы/истории, чат). Детали — в **SPEC_ALIGNMENT.md**.

---

## 1. Структура проекта

```
gogomarket/
├── src/
│   ├── App.tsx              # Роутинг: /, /buyer, /buyer/product/:id, /seller, /courier, /admin
│   ├── main.tsx             # Точка входа, подключение index.css
│   ├── index.css            # Глобальные стили, nav, card, btn
│   ├── components/
│   │   ├── Layout.tsx       # Шапка (навигация), <Outlet />, футер, skip-link
│   │   ├── CartBadge.tsx    # Счётчик корзины в шапке (localStorage + custom event)
│   │   ├── PageTitle.tsx    # document.title по странице
│   │   └── ErrorBoundary.tsx # Обработка ошибок рендера
│   ├── pages/
│   │   ├── Home.tsx         # Главная, выбор роли
│   │   ├── Buyer.tsx        # Каталог / Рилсы (вкладки), истории (лента), поиск, корзина, заказы; sellerType → В корзину / Связаться
│   │   ├── BuyerProduct.tsx # Страница товара; FULL → В корзину, SIMPLE → Связаться + бейдж Dealer
│   │   ├── ChatView.tsx     # Чат с GOGO AI Помощником (getAISupport), контекст товара ?product=
│   │   ├── Seller.tsx       # SELLER_FULL (инвентарь) / SELLER_SIMPLE (объявления: категории, пробег, площадь), ИИ-описание
│   │   ├── Courier.tsx      # Доставки, фильтр по статусу, смена статуса
│   │   └── Admin.tsx        # Статистика, пользователи, Модерация/Настройки
│   ├── data/
│   │   ├── catalog.ts       # Статичный каталог товаров (id, name, price, description)
│   │   ├── orders.ts        # Заказы покупателя: loadOrders, addOrder, saveOrders (localStorage)
│   │   └── sellerProducts.ts # Товары продавца: SellerProduct, load/save (localStorage)
│   ├── services/
│   │   └── geminiService.ts # generateAIDescription (Seller), getAISupport (ChatView)
│   ├── types.ts             # UserRole (SELLER_FULL, SELLER_SIMPLE, …), SellerType, SimpleCategory
│   └── lib/
│       └── gemini.ts        # Низкоуровневый вызов Gemini API
├── deploy/nginx-spa.conf
├── scripts/server-setup.sh, server-nginx-spa.sh
├── .github/workflows/deploy.yml  # Автодеплой на Digital Ocean при push в main
└── DEPLOY_DIGITAL_OCEAN.md, README.md, .env.example
```

Роуты: одна роль — один экран (без разделения на отдельные View-файлы по типу продавца/покупателя).

---

## 2. Разделение «Полный магазин» (SELLER_FULL) и «Объявления» (SELLER_SIMPLE)

**В текущем коде такого разделения нет.**

- В репозитории **нет файлов** `SellerView.tsx` и `BuyerView.tsx`.
- **Нет констант/типов** `SELLER_FULL` и `SELLER_SIMPLE`, нет ветвления по типу продавца (магазин vs объявления).

**Что есть сейчас:**

- **Продавец:** один сценарий в `Seller.tsx` — добавление/редактирование товара (название, цена, описание), список «Мои товары», ИИ-описание. Нет выбора «магазин» / «только объявления».
- **Покупатель:** один сценарий в `Buyer.tsx` и `BuyerProduct.tsx` — каталог, поиск, корзина, оформление заказа, «Мои заказы». Нет разного отображения для «магазин» vs «объявления».

**Если вводить SELLER_FULL / SELLER_SIMPLE по ТЗ**, логично было бы:

- Ввести тип продавца (например, в профиле или при создании товара): `sellerType: 'full' | 'simple'`.
- В **SellerView.tsx** (или внутри **Seller.tsx**):
  - `sellerType === 'full'` — полный магазин: каталог, остатки, доставка, возможно отдельный лендинг магазина.
  - `sellerType === 'simple'` — только объявления: форма «название + описание + контакты», без корзины/оплаты.
- В **BuyerView.tsx** (или внутри **Buyer.tsx** / карточки товара):
  - Для товара из «магазина» — кнопка «В корзину», цена, доставка.
  - Для «объявления» — кнопка «Написать продавцу» / показать контакты, без корзины.

Примеры условий **как они могли бы выглядеть** (сейчас в коде их нет):

```tsx
// Условный пример для SellerView.tsx (файла нет в проекте):
if (sellerType === 'SELLER_FULL') {
  return <SellerFullStore products={products} onEditInventory={...} />
}
if (sellerType === 'SELLER_SIMPLE') {
  return <SellerSimpleAds listings={listings} onContact={...} />
}

// Условный пример для BuyerView.tsx (файла нет в проекте):
const isFromFullStore = product.sellerType === 'SELLER_FULL'
return (
  <>
    {isFromFullStore && <AddToCartButton productId={product.id} />}
    {!isFromFullStore && <ContactSellerButton sellerId={product.sellerId} />}
  </>
)
```

Итого: архитектурного разделения SELLER_FULL / SELLER_SIMPLE в текущих файлах **нет**; отчёт описывает, как его можно добавить при доработке по ТЗ.

---

## 3. Интеграция ИИ (Gemini)

**Что реализовано:**

| Функция | Файл | Назначение |
|--------|------|------------|
| **Генерация описания товара** | `src/lib/gemini.ts` | `generateProductDescription(productName: string): Promise<string>` — запрос к `gemini-pro:generateContent`, промпт: «Краткое описание товара для магазина (1–2 предложения): {название}». |
| Использование в UI | `src/pages/Seller.tsx` | Кнопка «Сгенерировать описание (ИИ)» вызывает `generateProductDescription`, результат подставляется в поле описания. |

**Конфигурация:**

- Ключ API: переменная окружения `VITE_GEMINI_API_KEY` (см. `.env.example`).
- Без ключа: возвращается текст-подсказка «Добавьте VITE_GEMINI_API_KEY…», без вызова API.

**Других вызовов Gemini в проекте нет** (нет чата, модерации, тегов, категорий через ИИ и т.п.).

---

## 4. Социальный e-commerce: рилсы и истории

**В текущем коде не реализовано.**

- Нет компонентов/страниц с рилсами (вертикальный скролл видео).
- Нет компонентов/страниц со сторис (истории).
- Нет привязки товаров к рилсам/историям (нет полей типа `reelId`, `storyId` у товара, нет отображения товара в рилле/сторисе).

То есть логика «социального e-commerce» (рилсы и истории и их связь с товарами) **в коде отсутствует**; её нужно проектировать и реализовывать отдельно по ТЗ.

---

## 5. Текущий статус и что доработать

**Сделано (MVP):**

- Роли: Покупатель, Продавец, Курьер, Админ (отдельные страницы и базовый функционал).
- Покупатель: каталог (статичный), поиск, корзина (localStorage), оформление заказа, «Мои заказы» (localStorage).
- Продавец: добавление/редактирование/удаление товаров (localStorage), генерация описания через Gemini.
- Курьер: список доставок, фильтр по статусу, смена статуса (localStorage).
- Админ: блоки статистики и пользователей (мок), заглушки Модерация/Настройки.
- Общее: Layout, навигация, счётчик корзины, ErrorBoundary, skip-link, деплой на Digital Ocean (GitHub Actions), SPA (Nginx try_files).

**Нет в репозитории / по ТЗ нужно доработать:**

1. **Архитектура продавца:** разделение SELLER_FULL (полный магазин) и SELLER_SIMPLE (объявления); при необходимости — отдельные View (например, SellerView.tsx/BuyerView.tsx) или секции внутри текущих Seller.tsx/Buyer.tsx с условиями по типу продавца/типу листинга.
2. **Бэкенд и БД:** пока только localStorage; нет API, авторизации, реальных заказов и доставок.
3. **Рилсы и истории:** нет компонентов и логики; нет привязки товаров к контенту.
4. **Доп. функции Gemini:** только описание товара; по ТЗ могут понадобиться модерация, подбор категорий, чат и т.д.
5. **Спеки/ТЗ:** в репозитории нет файлов *SPEC* или *ТЗ*; точный перечень «что осталось» нужно сверять с вашим отдельным ТЗ/документом требований.

---

## Краткие ответы на вопросы

| Вопрос | Ответ |
|--------|--------|
| Как в коде разделены «Полный магазин» и «Объявления» (SELLER_FULL vs SELLER_SIMPLE)? | **Не разделены.** В проекте нет SELLER_FULL/SELLER_SIMPLE, нет SellerView.tsx/BuyerView.tsx. Есть единый сценарий в Seller.tsx и Buyer.tsx. |
| Примеры условий в SellerView.tsx и BuyerView.tsx? | **Файлов нет.** В отчёте выше приведены условные примеры того, как такие условия могли бы выглядеть при введении типов продавца. |
| Какие функции Gemini интегрированы и где прописаны? | **Одна:** генерация описания товара. Реализация: `src/lib/gemini.ts` (функция `generateProductDescription`), вызов из `src/pages/Seller.tsx`. |
| Как реализованы рилсы/истории и привязка к товарам? | **Не реализованы.** Социальный e-commerce (рилсы, истории, привязка к товарам) в коде отсутствует. |
| Текущий статус и что осталось по ТЗ? | **Статус:** рабочий фронтенд-MVP с 4 ролями, localStorage, деплоем. **Осталось:** ввести SELLER_FULL/SELLER_SIMPLE по ТЗ, бэкенд/БД, рилсы и истории, при необходимости расширить использование Gemini; точный список — по вашему ТЗ. |
